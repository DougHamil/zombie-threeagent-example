{"version":3,"sources":["zombie/scene/system/entity.cljs"],"mappings":";AAKA,AAAA;;;;;;;;;AAAA,AAAA,CAAA,AAAA,+EAAAA,/EAASK;;AAAT,CAAA,AAAA,2FAAA,3FAASA,sGAEAI,EAAEA;;AAFX,AAAA,YAAA,RAESA;AAFT,AAGI,gDAAA,2CAAA,pFAACC,sBAAOF,8HAAyBG;;;AAHrC,CAAA,AAAA,8FAAA,9FAASN,yGAIGI,EAAEA;;AAJd,AAAA,YAAA,RAIYA;AAJZ,AAAA;;;AAAA,CAAA,AAAA,sGAAA,tGAASJ,iHAKWI,EAAEA,MAAEG,GAAGC,IAAIC;;AAL/B,AAAA,YAAA,RAKoBL;AALpB,AAMI,OAACM,mDAAMJ,sCAAkBK,gBAAMJ,GAAGC;;;AANtC,CAAA,AAAA,wGAAA,xGAASR,mHAOaI,EAAEA,MAAEG,GAAGC,IAAIC;;AAPjC,AAAA,YAAA,RAOsBL;AAPtB,AAQI,GAAM,OAAA,NAAMG;AAAZ,AACE,AAACK,cAAiBJ;;AADpB;;AAEA,AAACK,+BAAiBX,WAAIK;;AACtB,OAACG,mDAAMJ,sCAAkBQ,iBAAOP;;;AAXpC,CAAA,AAAA,2FAAA,3FAASP,sGAYAI,EAAEW;;AAZX,AAAA,YAAA,RAYSX;AAZT,AAAA;;;AAAA,CAAA,mDAAA,nDAASJ;AAAT,AAAA,AAAA;;;AAAA,CAAA,yDAAA,zDAASA;;AAAT,CAAA,4DAAA,5DAASA;;AAAT,CAAA,iEAAA,WAAAJ,mBAAAC,qBAAAC,pHAASE;AAAT,AAAA,OAAAD,iBAAAF,qBAAA;;;AAAA;;;+CAAA,/CAASI,sGAAcC,IAAIC;AAA3B,AAAA,YAAAH,wCAAuBE,IAAIC;;;AAAlBH,AAcT,oCAAA,pCAAMgB,gFAAQC;AAAd,AACE,OAAChB,6CAAegB,UAAU,6CAAA,7CAACC","names":["cljs.core/PROTOCOL_SENTINEL","this__4450__auto__","writer__4451__auto__","opt__4452__auto__","cljs.core/-write","zombie.scene.system.entity/EntitySystem","zombie.scene.system.entity/->EntitySystem","bus","local-state","_","cljs.core/reset!","zombie.state.databases/entity-objects","id","obj","_cfg","cljs.core.swap_BANG_","cljs.core/assoc","js/console.error","zombie.util.messaging/drop-all","cljs.core/dissoc","_delta-time","zombie.scene.system.entity/create","event-bus","cljs.core.atom"],"sourcesContent":["(ns zombie.scene.system.entity\r\n  (:require [threeagent.system :refer [ISystem]]\r\n            [zombie.util.messaging :as message]\r\n            [zombie.state.databases :as db]))\r\n\r\n(deftype EntitySystem [bus local-state]\r\n  ISystem\r\n  (init [_ _]\r\n    (reset! local-state {:current-db db/entity-objects}))\r\n  (destroy [_ _])\r\n  (on-entity-added [_ _ id obj _cfg]\r\n    (swap! db/entity-objects assoc id obj))\r\n  (on-entity-removed [_ _ id obj _cfg]\r\n    (when (nil? id)\r\n      (js/console.error obj))\r\n    (message/drop-all bus id)\r\n    (swap! db/entity-objects dissoc id))\r\n  (tick [_ _delta-time]))\r\n\r\n(defn create [event-bus]\r\n  (->EntitySystem event-bus (atom {})))\r\n"]}