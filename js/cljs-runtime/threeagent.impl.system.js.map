{"version":3,"sources":["threeagent/impl/system.cljs"],"mappings":"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","names":["threeagent.impl.system/dispatch-on-added","context","entity-context","entity-id","entity-obj","entity-config","systems","callbacks","seq__10005","cljs.core/seq","chunk__10006","count__10007","i__10008","vec__10015","cljs.core.nth","temp__5753__auto__","cljs.core/chunked-seq?","c__4638__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__10018","cljs.core/first","cljs.core/next","k","v","sys","cljs.core.get","cb","threeagent.system/on-entity-added","cljs.core/fn?","threeagent.impl.system/dispatch-on-removed","seq__10021","chunk__10022","count__10023","i__10024","vec__10031","vec__10034","threeagent.system/on-entity-removed","threeagent.impl.system/dispatch-on-tick","delta-time","seq__10037","chunk__10038","count__10039","i__10040","vec__10047","vec__10050","_","system","threeagent.system/tick","threeagent.impl.system/dispatch-init","cljs.core.assoc","seq__10053","chunk__10054","count__10055","i__10056","vec__10063","vec__10066","threeagent.system/init","seq__10069","chunk__10070","count__10071","i__10072","threeagent.impl.system/dispatch-destroy","seq__10073","chunk__10074","count__10075","i__10076","vec__10083","vec__10086","threeagent.system/destroy","seq__10089","chunk__10090","count__10091","i__10092"],"sourcesContent":["(ns threeagent.impl.system\n  (:require [threeagent.impl.types :refer [Context]]\n            [threeagent.system :as system-protocol]))\n\n(defn dispatch-on-added [^Context context entity-context entity-id ^js entity-obj entity-config]\n  (let [systems (.-systems context)\n        callbacks (array)]\n    (doseq [[k v] entity-config]\n      (when-let [sys (get systems k)]\n        (let [cb (system-protocol/on-entity-added sys entity-context entity-id entity-obj v)]\n          (when (fn? cb)\n            (.push callbacks cb)))))\n    callbacks))\n\n(defn dispatch-on-removed [^Context context entity-context entity-id ^js entity-obj entity-config]\n  (let [systems (.-systems context)\n        callbacks (array)]\n    (doseq [[k v] entity-config]\n      (when-let [sys (get systems k)]\n        (let [cb (system-protocol/on-entity-removed sys entity-context entity-id entity-obj v)]\n          (when (fn? cb)\n            (.push callbacks cb)))))\n    callbacks))\n\n(defn dispatch-on-tick [^Context context delta-time]\n  (doseq [[_ system] (.-systems context)]\n    (system-protocol/tick system delta-time)))\n  \n(defn dispatch-init [systems context]\n  (let [context (assoc context :systems systems)\n        callbacks (array)]\n    (doseq [[_ system] systems]\n      (let [cb (system-protocol/init system context)]\n        (when (fn? cb)\n          (.push callbacks cb))))\n    (doseq [cb callbacks]\n      (cb))))\n\n(defn dispatch-destroy [systems context]\n  (let [context (assoc context :systems systems)\n        callbacks (array)]\n    (doseq [[_ system] systems]\n      (let [cb (system-protocol/destroy system context)]\n        (when (fn? cb)\n          (.push callbacks cb))))\n    (doseq [cb callbacks]\n      (cb))))\n"]}