{"version":3,"sources":["zombie/util/messaging.cljs"],"mappings":"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","names":["zombie$util$messaging$IEventBus$drop_all$dyn","x__4509__auto__","m__4510__auto__","zombie.util.messaging/drop-all","goog/typeOf","m__4508__auto__","cljs.core/missing-protocol","zombie$util$messaging$IEventBus$send$dyn","zombie.util.messaging/send","var_args","G__10776","js/Error","zombie$util$messaging$IEventBus$on$dyn","zombie.util.messaging/on","G__10778","zombie.util.messaging/IEventBus","this","entity-id","type","payload","callback-fn","cljs.core/PROTOCOL_SENTINEL","this__4450__auto__","writer__4451__auto__","opt__4452__auto__","cljs.core/-write","zombie.util.messaging/EventBus","zombie.util.messaging/->EventBus","subs","_","cljs.core.swap_BANG_","cljs.core/dissoc","entity-ids","cljs.core/coll?","seq__10779","cljs.core/seq","chunk__10780","count__10781","i__10782","temp__5753__auto__","cljs.core/chunked-seq?","c__4638__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","seq__10791","chunk__10792","count__10793","i__10794","seq__10795","chunk__10796","count__10797","i__10798","handler","cljs.core/deref","cljs.core.get_in","seq__10799","chunk__10800","count__10801","i__10802","cljs.core/update-in","cljs.core/conj","zombie.util.messaging/create-event-bus","cljs.core.atom"],"sourcesContent":["(ns zombie.util.messaging)\r\n\r\n(defprotocol IEventBus\r\n  (drop-all [this entity-id])\r\n  (send\r\n    [this entity-id type payload]\r\n    [this type payload])\r\n  (on\r\n    [this type callback-fn]\r\n    [this entity-id type callback-fn]))\r\n\r\n(deftype EventBus [subs]\r\n  IEventBus\r\n  (drop-all [_ entity-id]\r\n    (when entity-id\r\n      (swap! subs dissoc entity-id)))\r\n  (send [this type payload]\r\n    (send this nil type payload))\r\n  (send [_ entity-ids type payload]\r\n    (if (coll? entity-ids)\r\n      (doseq [entity-id entity-ids]\r\n        (doseq [handler (get-in @subs [entity-id type])]\r\n          (handler payload)))\r\n      (doseq [handler (get-in @subs [entity-ids type])]\r\n        (handler payload))))\r\n  (on [this type callback-fn]\r\n    (on this nil type callback-fn))\r\n  (on [_ entity-id type callback-fn]\r\n    (swap! subs update-in [entity-id type] conj callback-fn)))\r\n\r\n(defn create-event-bus []\r\n  (->EventBus (atom {})))\r\n"]}